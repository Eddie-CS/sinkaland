<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="page_title">SINNKAWA® Locations | Find Our Stores</title>

    <!-- Meta Tags -->
    <meta name="description" content="Find all SINNKAWA® store locations in Singapore. Use our interactive map and filters to discover our flagship stores, themed cafe, and exclusive gift shops in Chinatown and Haji Lane.">
    <meta name="keywords" content="SINNKAWA, Singapore, stores, locations, Chinatown, Haji Lane, cafe, gift shop">
    <meta name="author" content="SINNKAWA®">
    
    <!-- Favicon -->
    <link rel="icon" href="assets/LOGO/网站缩略图.png" type="image/png">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Poppins:wght@300;400;500;700&display=swap">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- i18next for translations -->
    <script src="https://unpkg.com/i18next@22.4.9/i18next.min.js"></script>

    <!-- Custom Styles and Tailwind Configuration -->
    <style type="text/tailwindcss">
        .filter-btn {
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
            background-color: white;
            color: #374151;
            cursor: pointer;
        }
        .filter-btn.active,
        .filter-btn:hover {
            background-color: #89d6d5;
            color: white;
            border-color: #89d6d5;
        }
        #store-modal-backdrop, #cafe-modal-backdrop, #checkin-modal-backdrop, #bot-modal-backdrop {
            transition: opacity 0.3s ease-in-out;
        }
        #store-modal-content, #cafe-modal-content, #checkin-modal-content, #bot-modal-content {
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        #bot-modal-content {
            width: 90%;
            max-width: 400px;
            height: 70vh;
        }
        #bot-messages {
            flex-grow: 1;
            overflow-y: auto;
        }
        .bot-message {
            align-self: flex-start;
            background-color: #f0fcfc;
            padding: 0.75rem;
            border-radius: 16px 16px 16px 0;
            max-width: 80%;
        }
        .user-message {
            align-self: flex-end;
            background-color: #89d6d5;
            color: white;
            padding: 0.75rem;
            border-radius: 16px 16px 0 16px;
            max-width: 80%;
        }
        /* Footer link language display logic */
        html[lang="zh"] .en-link { display: none; }
        html[lang="en"] .zh-link { display: none; }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#89d6d5',        // 主题色 (Theme Color)
                        'primary-hover': '#76c4c3',  // 主题悬浮色 (Theme Hover)
                        'secondary': '#f0fcfc',      // 背景色 (Background)
                        'accent': '#ffb8b8',         // 强调色 (Accent)
                        'accent-hover': '#ffa9a9',   // 强调悬浮色 (Accent Hover)
                        'dark': '#4a5c5c',           // 深色文字 (Dark Text)
                        'muted': '#7f9595',          // 浅色文字 (Muted Text)
                        'light': '#FFFFFF',          // 卡片背景 (Card Background)
                        'light-border': '#eafaf9',   // 边框色 (Border)
                    },
                    fontFamily: {
                        sans: ['Poppins', '"Noto Sans SC"', 'sans-serif'],
                        display: ['Poppins', '"Noto Sans SC"', 'sans-serif']
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-secondary text-dark font-sans antialiased">

    <!-- Header & Navigation -->
    <header class="sticky top-0 w-full bg-light/80 backdrop-blur-sm shadow-sm z-40 transition-all duration-200">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20 md:h-24">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="flex-shrink-0">
                        <img src="assets/LOGO/大头无r.png" alt="SINNKAWA® Logo" class="h-20 md:h-24">
                    </a>
                    <a href="index.html" class="ml-4 text-dark hover:text-primary font-medium transition-all duration-200">
                        <i class="fa fa-home"></i> <span data-i18n-key="nav_home">回到主页</span>
                    </a>
                </div>

                <!-- Main Navigation -->
                <nav class="hidden md:flex space-x-8" aria-label="Main Navigation">
                    <a href="stores.html" class="text-primary font-medium transition-all duration-200" data-i18n-key="nav_locations"></a>
                    <button id="news-nav-button" class="text-dark hover:text-primary font-medium transition-all duration-200" data-i18n-key="nav_news"></button>
                    <a href="index copy.html#characters" class="text-dark hover:text-primary font-medium transition-all duration-200" data-i18n-key="nav_characters"></a>
                    <a href="index copy.html#products" class="text-dark hover:text-primary font-medium transition-all duration-200" data-i18n-key="nav_products"></a>
                </nav>
                
                <!-- Language and AI Chat -->
                <div class="flex items-center space-x-4">
                    <div class="relative group">
                        <button id="language-selector" aria-label="Select Language" class="flex items-center text-sm font-medium hover:text-primary transition-all duration-200 bg-primary/10 px-3 py-1 rounded-full">
                            <i class="fa fa-globe text-lg text-primary" aria-hidden="true"></i>
                        </button>
                        <div class="absolute right-0 mt-2 w-36 bg-light shadow-lg rounded-md overflow-hidden opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                            <a href="#" class="language-option block px-4 py-2 text-sm text-dark hover:bg-primary/10 hover:text-primary transition-all duration-200 flex items-center" data-lang="en">English</a>
                            <a href="#" class="language-option block px-4 py-2 text-sm text-dark hover:bg-primary/10 hover:text-primary transition-all duration-200 flex items-center" data-lang="zh">中文</a>
                        </div>
                    </div>
                    <button id="desktop-ai-bot-button" class="hidden md:flex items-center gap-2 bg-primary/10 hover:bg-primary/20 text-primary px-4 py-2 rounded-full transition-all">
                        <i class="fa fa-comments"></i>
                        <span data-i18n-key="chat_with_us"></span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- Stores Section -->
        <section id="stores" class="py-16 md:py-20 bg-primary/5">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h1 class="text-3xl md:text-5xl font-bold mb-4 font-display" data-i18n-key="locations_title"></h1>
                    <p class="text-muted max-w-2xl mx-auto" data-i18n-key="locations_subtitle"></p>
                </div>
                <div class="store-filters mb-8 p-4 bg-white rounded-lg shadow-sm flex flex-col md:flex-row gap-4 max-w-4xl mx-auto">
                    <div class="relative flex-grow">
                        <input type="text" id="store-search-input" class="w-full pl-10 pr-4 py-3 rounded-full border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-primary focus:border-primary" data-i18n-placeholder="search_placeholder">
                        <i class="fa fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>
                    <div id="store-filter-buttons" class="flex-shrink-0 flex flex-wrap gap-2 justify-center items-center">
                        <!-- Filter buttons will be generated by JavaScript -->
                    </div>
                </div>
                <div id="store-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
                    <!-- Store cards will be generated by JavaScript -->
                </div>
                <p id="no-stores-found" class="text-center text-muted py-8 hidden" data-i18n-key="no_stores_found"></p>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-white text-dark pt-16 pb-8 border-t border-light-border">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row gap-8 mb-12">
                <div class="md:w-1/6">
                    <a href="index copy.html"><img src="assets/LOGO/logoAI文件.png" alt="SINNKAWA® Logo" class="h-24 mb-4"></a>
                    <p class="text-muted font-medium italic">Singapore meet Cuteness!</p>
                    <div class="mt-4 text-muted text-sm">
                        <p data-i18n-key="footer_hours"></p>
                        <p data-i18n-key="footer_open_days"></p>
                    </div>
                </div>
                <div class="md:w-5/6 flex flex-col md:flex-row gap-8">
                    <div class="md:w-1/3">
                        <h4 class="text-lg font-semibold mb-6 text-dark" id="footer-discover-title"></h4>
                        <ul class="space-y-4" id="footer-discover-links"></ul>
                    </div>
                    <div class="md:w-1/3">
                        <h4 class="text-lg font-semibold mb-6 text-dark" id="footer-stay-title"></h4>
                        <ul class="space-y-4" id="footer-stay-links"></ul>
                    </div>
                    <div class="md:w-1/3">
                        <h4 class="text-lg font-semibold mb-6 text-dark" id="footer-get-title"></h4>
                        <ul class="space-y-4" id="footer-get-links"></ul>
                    </div>
                </div>
            </div>
            <div class="border-t border-muted/20 pt-6 flex flex-col md:flex-row justify-between items-start text-muted text-xs">
                <div class="md:w-3/5 mb-4 md:mb-0">
                    <p class="font-bold" data-i18n-key="footer_rights_bold"></p>
                    <p class="mt-2" data-i18n-key="footer_rights_legal"></p>
                </div>
                <div class="md:w-2/5 md:text-right">
                    <p class="italic" data-i18n-key="footer_website_status"></p>
                </div>
            </div>
        </div>
    </footer>

    <!-- AI Bot Modal -->
    <div id="bot-modal" class="fixed inset-0 z-[102] flex items-center justify-center hidden">
        <div id="bot-modal-backdrop" class="absolute inset-0 bg-black/60 opacity-0"></div>
        <div id="bot-modal-content" class="relative bg-light rounded-2xl shadow-xl m-4 overflow-hidden transform scale-95 opacity-0 flex flex-col">
            <div class="bg-primary text-white p-4 flex justify-between items-center">
                <h3 class="font-bold">
                    <span class="en-link">KAKAWAWA - AI Assistant</span>
                    <span class="zh-link">新小哇 - AI 助手</span>
                </h3>
                <button id="close-bot-modal-btn" class="text-white text-xl">&times;</button>
            </div>
            <div id="bot-messages" class="p-4 flex flex-col gap-4">
                <div class="bot-message">
                    <span class="en-link">Hello! Welcome to SINNKAWA. How can I assist you today?</span>
                    <span class="zh-link">你好！欢迎来到SINNKAWA。我能为你提供什么帮助？</span>
                </div>
            </div>
            <div id="bot-input-container" class="p-4 border-t border-light-border flex gap-2">
                <input type="text" id="bot-input" data-i18n-placeholder="bot_placeholder" class="flex-grow p-2 border rounded-full focus:ring-primary focus:border-primary">
                <button id="bot-send" class="bg-primary text-white rounded-full w-10 h-10 flex items-center justify-center">
                    <i class="fa fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Cafe News Modal -->
    <div id="cafe-modal" class="fixed inset-0 z-[100] flex items-center justify-center hidden">
        <div id="cafe-modal-backdrop" class="absolute inset-0 bg-black/60 opacity-0"></div>
        <div id="cafe-modal-content" class="relative bg-light rounded-2xl shadow-xl w-11/12 max-w-4xl m-4 overflow-hidden transform scale-95 opacity-0">
            <button id="close-cafe-modal-btn" class="absolute top-3 right-4 text-dark hover:text-primary text-3xl z-10">&times;</button>
            <div class="lg:grid lg:grid-cols-2 lg:gap-4 items-center">
                <div class="p-8 lg:p-12">
                    <h2 class="text-3xl font-bold font-display text-dark mb-3" data-i18n-key="news_title"></h2>
                    <p class="text-muted mb-6" data-i18n-key="news_subtitle"></p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button id="cafe-checkin-btn" class="inline-block bg-accent hover:bg-accent-hover text-white font-semibold px-6 py-3 rounded-full transition-all duration-200 transform hover:scale-105" data-i18n-key="news_cta_unlock"></button>
                        <a href="#" onclick="openCafeMenu(); return false;" class="inline-block bg-light hover:bg-gray-50 text-dark border border-light-border font-semibold px-6 py-3 rounded-full transition-all duration-200 transform hover:scale-105" data-i18n-key="news_cta_menu"></a>
                    </div>
                </div>
                <div class="h-64 lg:h-full">
                    <img src="assets/门店照片/cafe.png" alt="SINNKAWA® Themed Cafe Interior" class="w-full h-full object-cover">
                </div>
            </div>
        </div>
    </div>

    <!-- Cafe Check-in Modal -->
    <div id="checkin-modal" class="fixed inset-0 z-[101] flex items-center justify-center hidden">
        <div id="checkin-modal-backdrop" class="absolute inset-0 bg-black/60 opacity-0"></div>
        <div id="checkin-modal-content" class="relative bg-light rounded-2xl shadow-xl w-11/12 max-w-2xl m-4 overflow-hidden transform scale-95 opacity-0">
            <button id="close-checkin-modal-btn" class="absolute top-3 right-4 text-dark hover:text-primary text-3xl z-10">&times;</button>
            <div class="p-6 md:p-8">
                <h3 class="text-2xl font-bold mb-4 text-center" data-i18n-key="news_cta_unlock"></h3>
                <div class="text-center">
                    <img src="assets/LOGO/网站缩略图.png" alt="Cafe Check-in" class="w-full max-w-md mx-auto rounded-lg mb-4">
                    <p class="text-muted text-sm mb-6">
                        <span class="en-link">Scan the QR code to check in and get your exclusive surprise!</span>
                        <span class="zh-link">扫描二维码打卡，领取您的专属惊喜！</span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        const translations = {
            en: {
                translation: {
                    // Page Title
                    page_title: "SINNKAWA® Locations | Find Our Stores in Singapore",
                    
                    // Nav & Header
                    nav_locations: "Locations",
                    nav_news: "Latest News",
                    nav_characters: "Characters",
                    nav_products: "Products",
                    chat_with_us: "Chat with us",

                    // Stores Section
                    locations_title: "Explore SINNKAWA's Locations",
                    locations_subtitle: "From the bustling streets of Chinatown to the vibrant Haji Lane, discover a world of cuteness at every corner.",
                    search_placeholder: "Search by name or keyword...",
                    filter_all: "All",
                    filter_chinatown: "Chinatown",
                    filter_haji_lane: "Haji Lane",
                    no_stores_found: "No locations found matching your criteria.",
                    directions: "Directions",
                    menu: "Menu",
                    store_flagship_name: "Chinatown Flagship Store",
                    store_flagship_address: "Address: 15 Trengganu St, #01-01, Singapore 058469",
                    store_flagship_desc: "The heart of our retail experience, showcasing the full range of SINNKAWA® merchandise.",
                    store_cafe_name: "SINNKAWA® Café",
                    store_cafe_address: "Address: 15 Trengganu St, #01-01 (Levels 3-4), Singapore 058469",
                    store_cafe_desc: "An immersive themed café offering unique culinary experiences.",
                    store_soul_art_name: "Soul Art @ 62 Haji Lane",
                    store_soul_art_address: "Address: 62 Haji Ln, Singapore 189252",
                    store_soul_art_desc: "A collaborative space featuring exclusive SINNKAWA® artworks.",
                    store_22_haji_name: "22 Haji Lane",
                    store_22_haji_address: "Address: 22 Haji Ln, Singapore 189215",
                    store_22_haji_desc: "A boutique for rare, limited-edition collectibles.",
                    store_68_haji_name: "68 Haji Lane",
                    store_68_haji_address: "Address: 68 Haji Ln, Singapore 189261",
                    store_68_haji_desc: "A chic, monochromatic concept store with a unique vibe.",
                    store_43_haji_name: "43 Haji Lane",
                    store_43_haji_address: "Address: 43 Haji Ln, Singapore 189236",
                    store_43_haji_desc: "Our newest location featuring interactive displays and photo opportunities.",
                    
                    // News & Cafe Modal
                    news_title: "Ding! You've Got an Invitation from SINNKAWA®'s Dreamy Café!",
                    news_subtitle: "Step into a world wrapped in cuteness and desserts! Our magical café is officially open, come taste desserts that smile and dreamy drinks that glow!",
                    news_cta_unlock: "Unlock Cafe Opening Surprise!",
                    news_cta_menu: "Get Cafe Menu",
                    
                    // AI Bot
                    bot_placeholder: "Type your message...",

                    // Footer
                    footer_hours: "Hours: 10am-10pm Daily (Café: 12am-8pm)",
                    footer_open_days: "Open 365 days a year, including public holidays.",
                    footer_rights_bold: "©2025 SINNKAWA® Singapore. All Rights Reserved.",
                    footer_rights_legal: "All visual assets of the SINNKAWA® brand are protected by copyright and trademark law.",
                    footer_website_status: "This is our brand's exploration outpost. The official flagship website (www.sinnkawa.com) is under construction.",
                }
            },
            zh: {
                translation: {
                    // 页面标题
                    page_title: "SINNKAWA® 地点 | 查找我们的新加坡门店",

                    // 导航 & 页眉
                    nav_home: "返回首页",
                    nav_locations: "探索地点",
                    nav_news: "最新消息",
                    nav_characters: "家族成员",
                    nav_products: "产品系列",
                    chat_with_us: "在线咨询",

                    // 门店部分
                    locations_title: "探索sinnkawa的秘密基地",
                    locations_subtitle: "从热闹的牛车水到充满活力的哈芝巷，在每一个角落发现一个可爱的世界。",
                    search_placeholder: "按名称或关键词搜索...",
                    filter_all: "全部",
                    filter_chinatown: "牛车水",
                    filter_haji_lane: "哈芝巷",
                    no_stores_found: "没有找到符合条件的地点。",
                    directions: "导航",
                    menu: "菜单",
                    store_flagship_name: "牛车水旗舰店",
                    store_flagship_address: "地址: 15 Trengganu St, #01-01, Singapore 058469",
                    store_flagship_desc: "我们零售体验的核心，全方位展示SINNKAWA®系列产品。",
                    store_cafe_name: "SINNKAWA® Café",
                    store_cafe_address: "地址: 15 Trengganu St, #01-01 (3-4层), Singapore 058469",
                    store_cafe_desc: "提供独特美食体验和拍照场景的沉浸式主题咖啡厅。",
                    store_soul_art_name: "Soul Art @ 62 哈芝巷",
                    store_soul_art_address: "地址: 62 Haji Ln, Singapore 189252",
                    store_soul_art_desc: "一个展示本地艺术家独家创作的合作空间。",
                    store_22_haji_name: "22 哈芝巷",
                    store_22_haji_address: "地址: 22 Haji Ln, Singapore 189215",
                    store_22_haji_desc: "专为寻找稀有、限量版收藏品而设的精品店。",
                    store_68_haji_name: "68 哈芝巷",
                    store_68_haji_address: "地址: 68 Haji Ln, Singapore 189261",
                    store_68_haji_desc: "一家别致的黑白主题概念店，拥有独特氛围。",
                    store_43_haji_name: "43 哈芝巷",
                    store_43_haji_address: "地址: 43 Haji Ln, Singapore 189236",
                    store_43_haji_desc: "我们最新的分店，设有互动展示和拍照打卡点。",
                    
                    // 新闻和咖啡厅弹窗
                    news_title: "叮！您收到了来自SINNKAWA®梦幻咖啡厅的邀请！",
                    news_subtitle: "踏入一个被可爱和甜点包裹的世界！我们的魔法咖啡厅正式开业，来品尝会微笑的甜点和会发光的梦幻饮品！",
                    news_cta_unlock: "解锁咖啡厅开业惊喜！",
                    news_cta_menu: "获取咖啡厅菜单",
                    
                    // AI机器人
                    bot_placeholder: "输入您的消息...",

                    // 页脚
                    footer_hours: "营业时间: 每天10:00-22:00 (咖啡厅: 12:00-20:00)",
                    footer_open_days: "全年365天营业，包括公共假期。",
                    footer_rights_bold: "©2025 SINNKAWA®新加坡。保留所有权利。",
                    footer_rights_legal: "SINNKAWA®品牌的所有视觉资产均受版权和商标法保护。",
                    footer_website_status: "这是我们品牌的探索前哨。官方旗舰网站(www.sinnkawa.com)正在建设中。"
                }
            }
        };
        
        const storeData = [
            { id: 'flagship', nameKey: "store_flagship_name", addressKey: "store_flagship_address", descKey: "store_flagship_desc", image: "assets/门店照片/IMG_3606.png", mapLink: "https://maps.app.goo.gl/AuDRqswjxYYgBVFg8", tags: "chinatown flagship" },
            { id: 'cafe', nameKey: "store_cafe_name", addressKey: "store_cafe_address", descKey: "store_cafe_desc", image: "assets/门店照片/cafe.png", mapLink: "https://maps.app.goo.gl/AuDRqswjxYYgBVFg8", menuLink: "#", tags: "chinatown cafe" },
            { id: 'soulart', nameKey: "store_soul_art_name", addressKey: "store_soul_art_address", descKey: "store_soul_art_desc", image: "assets/门店照片/soul.png", mapLink: "https://maps.app.goo.gl/QHbdCKU81UJwMuX27", tags: "haji lane art" },
            { id: 'haji22', nameKey: "store_22_haji_name", addressKey: "store_22_haji_address", descKey: "store_22_haji_desc", image: "assets/门店照片/22.png", mapLink: "https://maps.app.goo.gl/NgZPfmMp2egFZhAQ7", tags: "haji lane limited" },
            { id: 'haji68', nameKey: "store_68_haji_name", addressKey: "store_68_haji_address", descKey: "store_68_haji_desc", image: "assets/门店照片/68.png", mapLink: "https://maps.app.goo.gl/cPchyEaSGGsMjbg99", tags: "haji lane photo" },
            { id: 'haji43', nameKey: "store_43_haji_name", addressKey: "store_43_haji_address", descKey: "store_43_haji_desc", image: "assets/门店照片/43.png", mapLink: "https://maps.app.goo.gl/7zVMeVqAhUP7Nydc9", tags: "haji lane new" }
        ];

        const footerLinksData = {
            discover: {
                title: { en: "Discover <span class='text-primary'>SINNKAWA</span>", zh: "探索 <span class='text-primary'>SINNKAWA</span>" },
                links: [
                    { href: "index copy.html#characters", icon: "fa-paw", text: { en: "<span class='text-primary'>Sinnkawa</span>'s Members", zh: "角色故事" } },
                    { href: "stores.html", icon: "fa-map-marker", text: { en: "Main Outlets", zh: "线下门店" } },
                    { href: "index copy.html#products", icon: "fa-shopping-bag", text: { en: "Product Categories", zh: "零售类别" } },
                    { href: "#", icon: "fa-bullhorn", text: { en: "What's New", zh: "品牌动态" }, isButton: true, buttonId: "news-footer-button" }
                ]
            },
            stay: {
                title: { en: "Get Latest Updates", zh: "获取最新品牌资讯" },
                links: [
                    { href: "https://www.xiaohongshu.com/user/profile/664f08440000000003030e90", icon: "fa-book", text: { en: "RedNote", zh: "小红书" } },
                    { href: "https://www.instagram.com/sinnkawa_official/", icon: "fa-instagram", text: { en: "Instagram", zh: "Instagram" } },
                    { href: "https://www.tiktok.com/@sinnkawasingapore", icon: "fa-music", text: { en: "TikTok", zh: "TikTok" } },
                    { href: "https://www.threads.net/@sinnkawa_official", icon: "fa-comment", text: { en: "Threads", zh: "Threads" } }
                ]
            },
            get: {
                title: { en: "Stay Connected!", zh: "联系我们" },
                links: [
                    { href: "javascript:void(0);", icon: "fa-comments", text: { en: "Chat with AI Assistant", zh: "与AI助手聊天" }, onclick: "openBot()" },
                    { href: "https://wa.me/6597759906", icon: "fa-whatsapp", text: { en: "WhatsApp", zh: "WhatsApp" } },
                    { href: "https://forms.gle/a6PjifbkM7ovz42Z8", icon: "fa-pencil-square-o", text: { en: "Submit an Enquiry Form", zh: "提交问题表格" } }
                ]
            }
        };
        
        const botResponses = {
            "hello": { en: "Hello! How can I help?", zh: "你好！有什么可以帮你的吗？" },
            "store hours": { en: "Our stores are open 10am-10pm daily.", zh: "我们的门店每天上午10点到晚上10点营业。" },
            "default": { en: "Sorry, I can't answer that. Please try asking about store hours or locations.", zh: "抱歉，我无法回答。请尝试询问关于营业时间或门店位置的问题。" }
        };

        let allStoreCards = [];

        function initApp() {
            i18next.init({
                resources: translations,
                fallbackLng: 'en',
                lng: localStorage.getItem('sinnkawa-lang') || 'en'
            }).then(() => {
                document.documentElement.lang = i18next.language;
                updateAllContent();
            });

            i18next.on('languageChanged', (lng) => {
                document.documentElement.lang = lng;
                localStorage.setItem('sinnkawa-lang', lng);
                updateAllContent();
            });

            document.querySelectorAll('.language-option').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const lang = e.currentTarget.getAttribute('data-lang');
                    i18next.changeLanguage(lang);
                });
            });

            initStoreFinder();
            initCafeModal();
            initCheckinModal();
            initAIBot();
        }
        
        function updateAllContent() {
            updateStaticContent();
            populateStoreCards();
            generateFilterButtons();
            filterStores();
            populateFooterLinks();
        }

        function updateStaticContent() {
            document.querySelectorAll('[data-i18n-key]').forEach(el => {
                const key = el.getAttribute('data-i18n-key');
                el.innerHTML = i18next.t(key);
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                el.placeholder = i18next.t(key);
            });
             document.title = i18next.t('page_title');
        }

        function populateStoreCards() {
            const storeListContainer = document.getElementById('store-list');
            storeListContainer.innerHTML = '';
            storeData.forEach(store => {
                const card = document.createElement('div');
                card.className = "store-card bg-white rounded-lg shadow-lg overflow-hidden transition-all duration-300 hover:shadow-2xl hover:-translate-y-1 flex flex-col";
                card.dataset.tags = store.tags;
                card.dataset.id = store.id;

                let buttonsHTML = '';
                buttonsHTML += `<a href="${store.mapLink}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center bg-primary hover:bg-primary-hover text-white font-semibold px-5 py-2 rounded-full transition-all duration-200 text-sm">
                    <i class="fa fa-map-marker mr-2"></i> ${i18next.t('directions')}
                </a>`;
                if (store.menuLink) {
                    buttonsHTML += `<a href="#" onclick="openCafeMenu(); return false;" class="inline-flex items-center justify-center bg-gray-200 hover:bg-gray-300 text-dark font-semibold px-5 py-2 rounded-full transition-all duration-200 text-sm ml-2">
                        <i class="fa fa-cutlery mr-2"></i> ${i18next.t('menu')}
                    </a>`;
                }

                card.innerHTML = `
                    <div class="relative h-72">
                        <img src="${store.image}" alt="${i18next.t(store.nameKey)}" class="w-full h-full object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/eeeeee/cccccc?text=Image+Not+Found';">
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <h4 class="font-bold text-xl text-dark mb-2">${i18next.t(store.nameKey)}</h4>
                        <p class="text-muted text-sm mb-4">${i18next.t(store.addressKey)}</p>
                        <p class="text-dark/80 text-sm mb-4 flex-grow">${i18next.t(store.descKey)}</p>
                        <div class="mt-auto pt-4 flex flex-wrap gap-2">
                            ${buttonsHTML}
                        </div>
                    </div>
                `;
                storeListContainer.appendChild(card);
            });
            allStoreCards = Array.from(storeListContainer.children);
        }

        function generateFilterButtons() {
            const filterButtonsContainer = document.getElementById('store-filter-buttons');
            const currentActive = filterButtonsContainer.querySelector('.active')?.dataset.filter || 'all';
            let buttonsHTML = `
                <button class="filter-btn ${currentActive === 'all' ? 'active' : ''}" data-filter="all">${i18next.t('filter_all')}</button>
                <button class="filter-btn ${currentActive === 'chinatown' ? 'active' : ''}" data-filter="chinatown">${i18next.t('filter_chinatown')}</button>
                <button class="filter-btn ${currentActive === 'haji lane' ? 'active' : ''}" data-filter="haji lane">${i18next.t('filter_haji_lane')}</button>
            `;
            filterButtonsContainer.innerHTML = buttonsHTML;
        }

        function filterStores() {
            const searchInput = document.getElementById('store-search-input');
            const filterButtonsContainer = document.getElementById('store-filter-buttons');
            const noResultsMessage = document.getElementById('no-stores-found');
            
            const searchTerm = searchInput.value.toLowerCase();
            const activeFilter = filterButtonsContainer.querySelector('.active').dataset.filter;
            let visibleCount = 0;

            allStoreCards.forEach(card => {
                const storeInfo = storeData.find(s => s.id === card.dataset.id);
                if (!storeInfo) return;

                const cardTitle = i18next.t(storeInfo.nameKey).toLowerCase();
                const cardDesc = i18next.t(storeInfo.descKey).toLowerCase();
                const cardTags = card.dataset.tags;

                const matchesSearch = cardTitle.includes(searchTerm) || cardDesc.includes(searchTerm);
                const matchesFilter = activeFilter === 'all' || cardTags.includes(activeFilter);

                if (matchesSearch && matchesFilter) {
                    card.classList.remove('hidden');
                    visibleCount++;
                } else {
                    card.classList.add('hidden');
                }
            });
            noResultsMessage.classList.toggle('hidden', visibleCount > 0);
        }

        function initStoreFinder() {
            const searchInput = document.getElementById('store-search-input');
            const filterButtonsContainer = document.getElementById('store-filter-buttons');

            filterButtonsContainer.addEventListener('click', function(e) {
                if (e.target.matches('.filter-btn')) {
                    if (filterButtonsContainer.querySelector('.active')) {
                        filterButtonsContainer.querySelector('.active').classList.remove('active');
                    }
                    e.target.classList.add('active');
                    filterStores();
                }
            });
            searchInput.addEventListener('input', filterStores);
        }
        
        function populateFooterLinks() {
            const lang = i18next.language;
            
            document.getElementById('footer-discover-title').innerHTML = footerLinksData.discover.title[lang];
            document.getElementById('footer-discover-links').innerHTML = footerLinksData.discover.links.map(link => {
                const linkContent = `<i class="fa ${link.icon} w-5 text-center text-primary"></i>
                                     <span>
                                        <span class="en-link">${link.text.en}</span>
                                        <span class="zh-link">${link.text.zh}</span>
                                     </span>`;
                if (link.isButton) {
                    return `<li><button id="${link.buttonId}" class="flex items-center gap-2 text-dark hover:text-primary transition-all duration-200">${linkContent}</button></li>`;
                } else {
                    return `<li><a href="${link.href}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-dark hover:text-primary transition-all duration-200">${linkContent}</a></li>`;
                }
            }).join('');
            
            document.getElementById('footer-stay-title').textContent = footerLinksData.stay.title[lang];
            document.getElementById('footer-stay-links').innerHTML = footerLinksData.stay.links.map(link => `<li><a href="${link.href}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-dark hover:text-primary transition-all duration-200"><i class="fa ${link.icon} w-5 text-center text-primary"></i><span><span class="en-link">${link.text.en}</span><span class="zh-link">${link.text.zh}</span></span></a></li>`).join('');
            
            document.getElementById('footer-get-title').textContent = footerLinksData.get.title[lang];
            document.getElementById('footer-get-links').innerHTML = footerLinksData.get.links.map(link => `<li><a href="${link.href}" ${link.onclick ? `onclick="${link.onclick}"` : ''} class="flex items-center gap-2 text-dark hover:text-primary transition-all duration-200"><i class="fa ${link.icon} w-5 text-center text-primary"></i><span><span class="en-link">${link.text.en}</span><span class="zh-link">${link.text.zh}</span></span></a></li>`).join('');
            
            const newsFooterButton = document.getElementById('news-footer-button');
            if(newsFooterButton) newsFooterButton.addEventListener('click', openCafeModal);
        }

        function openCafeModal() {
            const modal = document.getElementById('cafe-modal');
            if (!modal) return;
            modal.classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('cafe-modal-backdrop').classList.add('opacity-100');
                document.getElementById('cafe-modal-content').classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function initCafeModal() {
            const modal = document.getElementById('cafe-modal');
            const openTriggers = document.querySelectorAll('#news-nav-button');
            const closeModalBtn = document.getElementById('close-cafe-modal-btn');
            const modalBackdrop = document.getElementById('cafe-modal-backdrop');

            function close() {
                if (!modal) return;
                modalBackdrop.classList.remove('opacity-100');
                document.getElementById('cafe-modal-content').classList.remove('scale-100', 'opacity-100');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
            openTriggers.forEach(btn => btn.addEventListener('click', openCafeModal));
            if(closeModalBtn) closeModalBtn.addEventListener('click', close);
            if(modalBackdrop) modalBackdrop.addEventListener('click', close);
        }

        function initCheckinModal() {
            const modal = document.getElementById('checkin-modal');
            const openTrigger = document.getElementById('cafe-checkin-btn');
            const closeModalBtn = document.getElementById('close-checkin-modal-btn');
            const modalBackdrop = document.getElementById('checkin-modal-backdrop');

            function open() {
                if (!modal) return;
                const cafeModal = document.getElementById('cafe-modal');
                if (cafeModal && !cafeModal.classList.contains('hidden')) {
                    document.getElementById('cafe-modal-backdrop').classList.remove('opacity-100');
                    document.getElementById('cafe-modal-content').classList.remove('scale-100', 'opacity-100');
                    setTimeout(() => cafeModal.classList.add('hidden'), 300);
                }
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modalBackdrop.classList.add('opacity-100');
                    document.getElementById('checkin-modal-content').classList.add('scale-100', 'opacity-100');
                }, 10);
            }
            function close() {
                if (!modal) return;
                modalBackdrop.classList.remove('opacity-100');
                document.getElementById('checkin-modal-content').classList.remove('scale-100', 'opacity-100');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
            if(openTrigger) openTrigger.addEventListener('click', open);
            if(closeModalBtn) closeModalBtn.addEventListener('click', close);
            if(modalBackdrop) modalBackdrop.addEventListener('click', close);
        }
        
        function openBot() {
            const botModal = document.getElementById('bot-modal');
            if (!botModal) return;
            botModal.classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('bot-modal-backdrop').classList.add('opacity-100');
                document.getElementById('bot-modal-content').classList.add('scale-100', 'opacity-100');
                document.getElementById('bot-input').focus();
            }, 10);
        }
        
        function initAIBot() {
            const botModal = document.getElementById('bot-modal');
            const desktopBotButton = document.getElementById('desktop-ai-bot-button');
            const closeBotModalBtn = document.getElementById('close-bot-modal-btn');
            const botBackdrop = document.getElementById('bot-modal-backdrop');
            const botInput = document.getElementById('bot-input');
            const botSend = document.getElementById('bot-send');
            const botMessages = document.getElementById('bot-messages');

            function closeBot() {
                if (!botModal) return;
                botBackdrop.classList.remove('opacity-100');
                document.getElementById('bot-modal-content').classList.remove('scale-100', 'opacity-100');
                setTimeout(() => botModal.classList.add('hidden'), 300);
            }

            function sendMessage() {
                const message = botInput.value;
                if (!message.trim()) return;
                
                const userMessageEl = document.createElement('div');
                userMessageEl.className = 'user-message';
                userMessageEl.textContent = message;
                botMessages.appendChild(userMessageEl);
                
                botInput.value = '';
                botMessages.scrollTop = botMessages.scrollHeight;
                
                setTimeout(() => {
                    const lowerMessage = message.toLowerCase();
                    const lang = i18next.language;
                    let response = botResponses.default[lang];
                    for (const [key, value] of Object.entries(botResponses)) {
                        if (lowerMessage.includes(key)) {
                            response = value[lang];
                            break;
                        }
                    }
                    const botMessageEl = document.createElement('div');
                    botMessageEl.className = 'bot-message';
                    botMessageEl.textContent = response;
                    botMessages.appendChild(botMessageEl);
                    botMessages.scrollTop = botMessages.scrollHeight;
                }, 500);
            }

            if(desktopBotButton) desktopBotButton.addEventListener('click', openBot);
            if(closeBotModalBtn) closeBotModalBtn.addEventListener('click', closeBot);
            if(botBackdrop) botBackdrop.addEventListener('click', closeBot);
            if(botSend) botSend.addEventListener('click', sendMessage);
            if(botInput) botInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });
        }

        window.openCafeMenu = function() {
            const lang = i18next.language;
            const menuUrl = lang === 'zh' ? 'assets/cafecn.png' : 'assets/cafeen.png';
            window.open(menuUrl, '_blank');
        }

        initApp();
    });
    </script>
</body>
</html>
